diff -r -x '*.config' -x '*git*' -x '*.md' -x '*.xml' d4j_buggy/Jsoup58/src/main/java/org/jsoup/Jsoup.java d4j_patched/Jsoup58/src/main/java/org/jsoup/Jsoup.java
250c250
<         return new Cleaner(whitelist).isValid(parseBodyFragment(bodyHtml, ""));
---
>         return new Cleaner(whitelist).isValidBodyHtml(bodyHtml);
diff -r -x '*.config' -x '*git*' -x '*.md' -x '*.xml' d4j_buggy/Jsoup58/src/main/java/org/jsoup/parser/Parser.java d4j_patched/Jsoup58/src/main/java/org/jsoup/parser/Parser.java
128a129,132
>     public static List<Node> parseFragment(String fragmentHtml, Element context, String baseUri, ParseErrorList errorList) {
>         HtmlTreeBuilder treeBuilder = new HtmlTreeBuilder();
>         return treeBuilder.parseFragment(fragmentHtml, context, baseUri, errorList, treeBuilder.defaultSettings());
>     }
diff -r -x '*.config' -x '*git*' -x '*.md' -x '*.xml' d4j_buggy/Jsoup58/src/main/java/org/jsoup/safety/Cleaner.java d4j_patched/Jsoup58/src/main/java/org/jsoup/safety/Cleaner.java
16a17
> import java.util.List;
78c79,80
<         return numDiscarded == 0;
---
>         return numDiscarded == 0
>             && dirtyDocument.head().childNodes().size() == 0; // because we only look at the body, but we start from a shell, make sure there's nothing in the head
80a83,91
>     public boolean isValidBodyHtml(String bodyHtml) {
>         Document clean = Document.createShell("");
>         Document dirty = Document.createShell("");
>         ParseErrorList errorList = ParseErrorList.tracking(1);
>         List<Node> nodes = Parser.parseFragment(bodyHtml, dirty.body(), "", errorList);
>         dirty.body().insertChildren(0, nodes);
>         int numDiscarded = copySafeNodes(dirty.body(), clean.body());
>         return numDiscarded == 0 && errorList.size() == 0;
>     }
