Only in after/: bears.json
Only in after/: classpath.info
diff -r -x '*.log' -x '*.config' -x '*git*' -x '*.md' -x '*.xml' before/src/main/java/spoon/support/visitor/java/JavaReflectionTreeBuilder.java after/src/main/java/spoon/support/visitor/java/JavaReflectionTreeBuilder.java
220c220
< 	public void visitAnnotation(Annotation annotation) {
---
> 	public void visitAnnotation(final Annotation annotation) {
223c223,233
< 		enter(new AnnotationRuntimeBuilderContext(ctAnnotation));
---
> 		enter(new AnnotationRuntimeBuilderContext(ctAnnotation) {
> 			@Override
> 			public void addMethod(CtMethod ctMethod) {
> 				try {
> 					Object value = annotation.getClass().getMethod(ctMethod.getSimpleName()).invoke(annotation);
> 					ctAnnotation.addValue(ctMethod.getSimpleName(), value);
> 				} catch (Exception ignore) {
> 					ctAnnotation.addValue(ctMethod.getSimpleName(), "");
> 				}
> 			}
> 		});
diff -r -x '*.log' -x '*.config' -x '*git*' -x '*.md' -x '*.xml' before/src/main/java/spoon/support/visitor/java/JavaReflectionVisitorImpl.java after/src/main/java/spoon/support/visitor/java/JavaReflectionVisitorImpl.java
156a157,159
> 			for (RtMethod method : getDeclaredMethods(annotation.annotationType())) {
> 				visitMethod(method);
> 			}
diff -r -x '*.log' -x '*.config' -x '*git*' -x '*.md' -x '*.xml' before/src/test/java/spoon/test/annotation/AnnotationTest.java after/src/test/java/spoon/test/annotation/AnnotationTest.java
8a9
> import spoon.reflect.annotations.PropertyGetter;
11a13
> import spoon.reflect.code.CtFieldRead;
28a31
> import spoon.reflect.declaration.CtNamedElement;
34d36
< import spoon.reflect.reference.CtPackageReference;
56a59
> import spoon.test.annotation.testclasses.PortRange;
60d62
< import spoon.test.annotation.testclasses.PortRange;
70d71
< 
72d72
< 
93a94,104
> 	}
> 
> 	@Test
> 	public void testAnnotationValueReflection() throws Exception {
> 		Factory factory = new Launcher().getFactory();
> 
> 		CtTypeReference reference = factory.createCtTypeReference(PropertyGetter.class);
> 		CtAnnotation annotation = factory.Interface().get(CtNamedElement.class).getMethod("getSimpleName").getAnnotation(reference);
> 
> 		assertEquals("The annotation must have a value", 1, annotation.getValues().size());
> 		assertEquals("NAME", ((CtFieldRead) annotation.getValue("role")).getVariable().getSimpleName());
